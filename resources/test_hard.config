# Configuration du serveur par défaut pour localhost:8080
server {
    port: 8080;
    host: 127.0.0.1;
    server_name: default.local;
    root: /workspaces/default;

    # Limitation de la taille du corps du client
    client_body_size: 2m; 

    # Pages d'erreur par défaut
    error_page: 404, /errors/404.html;
    error_page: 500, /errors/500.html;

    location / {
        allow_methods: GET, POST, DELETE;
        index: index.html;
    }

    location /uploads {
        allow_methods: POST;
        upload_store: /workspaces/uploaded_files;
    }

    location /cgi {
        cgi: /usr/bin/php-cgi, .php;
    }

    location /images {
        autoindex: on;
    }
}

# Configuration du serveur secondaire pour localhost:8081
server {
    port: 8081;
    host: 127.0.0.1;
    root: /workspaces/secondary;

    location / {
        allow_methods: GET, POST;
        index: welcome.html;
    }

    location /static {
        root: /workspaces/static_files;
    }

    location /redirection {
        return: http://default.local;
    }

    location /api {
        cgi: /usr/bin/python3, .py;
        allow_methods: GET, POST;
    }

    location /upload {
        allow_methods: POST;
        upload_store: /workspaces/uploaded_files_8081;
    }
}

# Configuration du serveur pour le domaine example.com
server {
    port: 8080;
    host: 127.0.0.1;
    server_name: example.com;
    root: /workspaces/example;

    location / {
        allow_methods: GET;
        index: homepage.html;
    }

    location /docs {
        autoindex: on;
        root: /workspaces/docs;
    }

    location /scripts {
        cgi: /bin/bash, .sh;
    }
}

# Serveur par défaut pour 127.0.0.1:8082
server {
    port: 8082;
    host: 127.0.0.1;
    root: /workspaces/default8082;

    location / {
        allow_methods: GET, POST;
        index: default8082.html;
    }
}

